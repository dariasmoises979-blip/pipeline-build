########################################
# ğŸ”„ WORKFLOW REUSABLE: Date Workflow
# Ejecuta anÃ¡lisis de integraciÃ³n y validaciones bÃ¡sicas.
# DiseÃ±ado para ser invocado desde otros workflows.
########################################

name: Reusable Date Workflow

# ğŸ”§ Definir como workflow reusable
on:
  workflow_call:  # Permite que otros workflows lo invoquen
    # secrets:
    #   SONAR_TOKEN:
    #     required: true
    # inputs:
    #   branch:
    #     description: 'Rama a analizar (por defecto: qa)'
    #     required: false
    #     type: string
    #     default: 'qa'

# ğŸ” Permisos mÃ­nimos requeridos
permissions:
  actions: read
  contents: read
  security-events: write

jobs:
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # ğŸ”§ JOB: INTEGRATION SETUP
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  integration:
    name: ğŸ§© Setup de IntegraciÃ³n
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¦ Checkout del cÃ³digo
        uses: actions/checkout@v4

      - name: ğŸ§° Preparar entorno
        run: echo "Configurando entorno base para pruebas de integraciÃ³n..."

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # ğŸ§© JOB: TEST UNITARIOS
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  test-unit:
    name: ğŸ§ª Unit Tests
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¦ Checkout del cÃ³digo
        uses: actions/checkout@v4

      - name: âš™ï¸ Configurar Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.12"

      - name: ğŸ“¥ Instalar dependencias
        run: |
          pip install flask pytest

      - name: â–¶ï¸ Ejecutar tests unitarios
        run: pytest -v

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # ğŸ”— JOB: TEST DE INTEGRACIÃ“N
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  test-integration:
    name: ğŸ”— Integration Tests
    runs-on: ubuntu-latest
    needs: test-unit

    steps:
      - name: ğŸ“¦ Checkout del cÃ³digo
        uses: actions/checkout@v4

      - name: ğŸ§© Ejecutar pruebas de integraciÃ³n
        run: echo "Comprueba que cada funciÃ³n o mÃ³dulo funciona correctamente en conjunto"
